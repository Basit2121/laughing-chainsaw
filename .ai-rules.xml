<?xml version="1.0" encoding="UTF-8"?>
<rules>
    <rule id="1">
        <description>Always load and follow ./.ai-rules.xml before any code generation step.</description>
    </rule>
</rules>

<allowedTechnologies>
    <backend>Flask</backend>
    <css>CSS + Tailwind CSS</css>
    <frontend>JQuery</frontend>
    <database>sqlite3 (stdlib only)</database>
</allowedTechnologies>

<rules>
    <rule id="1">
        <description>UI/UX Design Principles</description>
        <subrule id="1.1">
            <description>Create modern, clean, and professional UI design using Tailwind CSS with a clear visual hierarchy</description>
        </subrule>
        <subrule id="1.2">
            <description>Establish strong typography hierarchy: use heading levels (h1-h6) consistently with appropriate font sizes, weights, and spacing to create clear information structure</description>
        </subrule>
        <subrule id="1.3">
            <description>Maintain consistent spacing using Tailwind's spacing scale throughout all components and layouts</description>
        </subrule>
        <subrule id="1.4">
            <description>Ensure accessible color contrast ratios (WCAG AA compliant) for all text and interactive elements</description>
        </subrule>
        <subrule id="1.5">
            <description>Use semantic HTML5 elements to reinforce content structure and improve accessibility</description>
        </subrule>
        <subrule id="1.6">
            <description>Implement responsive design that works seamlessly across all device sizes (mobile, tablet, desktop)</description>
        </subrule>
        <subrule id="1.7">
            <description>Only override styles via Tailwind's @apply or custom CSS when absolutely necessary to maintain consistency</description>
        </subrule>
        <subrule id="1.8">
            <description>Avoid using Emojis in professional interface elements</description>
        </subrule>
        <subrule id="1.9">
            <description>Include high-quality, optimized images where applicable to enhance visual appeal without compromising performance</description>
        </subrule>
    </rule>

    <rule id="2">
        <description>Each page or feature must be implemented as its own Flask Blueprint with its own templates and static sub-folder.</description>
        <example structure="blueprints/&lt;feature&gt;/__init__.py"/>
    </rule>

    <rule id="3">
        <description>Place the JQuery code for each page in a separate JavaScript file named after the blueprint and located at static/js/&lt;blueprint-name&gt;.js. Include it only in the corresponding template via {% block page_js %}.</description>
    </rule>

    <rule id="4">
        <description>Create reusable Jinja2 components (macros) for common UI elements such as navbar, sidebar, footer, flash messages, and buttons. Store them in templates/components/ and import with {% from 'components/navbar.html' import navbar %}. Pass context explicitly to each macro.</description>
    </rule>

    <rule id="5">
        <description>Use sqlite3 stdlib only; implement a lightweight connection pool in db_utils.py that opens/closes connections per request via Flask's teardown_appcontext.</description>
    </rule>

    <rule id="6">
        <description>Auto-reload dev server on template/static changes: set app.config['TEMPLATES_AUTO_RELOAD'] = True and use Flask-DebugToolbar in development only.</description>
    </rule>

    <rule id="7">
        <description>Ship a lightweight health-check endpoint /health that returns { "status": "ok", "timestamp": "<iso8601>" } and runs SELECT 1 against the pooled DB.</description>
    </rule>

    <rule id="8">
        <description>Store all sensitive secrets (FLASK_SECRET_KEY, DB_URI, etc.) in a config.json file located in the project root; load it at startup with json.load(). Never commit config.json to git; provide a sample config.example.json instead.</description>
    </rule>

    <rule id="9">
        <description>The root route ('/') must serve index.html as the main entry point of the application. This should be implemented in the main app or a dedicated blueprint to ensure visitors land on the intended homepage.</description>
    </rule>

    <rule id="10">
        <description>Store database schema in schema.sql and implement a simple migration system in migrations/ folder. Each migration file should be numbered (001_initial.sql, 002_add_users.sql) and include both UP and DOWN statements.</description>
    </rule>

    <rule id="11">
        <description>Environment Setup and Execution: Create a virtual environment setup and automated execution system</description>
        <subrule id="11.1">
            <description>Generate a requirements.txt file listing all Python dependencies including Flask and any other required packages</description>
        </subrule>
        <subrule id="11.2">
            <description>Create a run.py script in the project root that automatically:
                - Checks for and creates a virtual environment (venv) if it doesn't exist
                - Activates the virtual environment
                - Installs all requirements from requirements.txt
                - Launches the Flask application with proper configuration
            </description>
        </subrule>
        <subrule id="11.3">
            <description>The run.py script should work cross-platform (Windows, macOS, Linux) and provide clear output about each step of the process</description>
        </subrule>
        <subrule id="11.4">
            <description>Include .gitignore to exclude the virtual environment directory and other non-essential files from version control</description>
        </subrule>
        <subrule id="11.5">
            <description>Ensure the run.py script sets appropriate environment variables for development mode (FLASK_ENV=development, FLASK_DEBUG=1)</description>
        </subrule>
    </rule>

    <rule id="12">
        <description>Code Quality and Function Design: Write clean, functional, and easy-to-understand code without OOP</description>
        <subrule id="12.1">
            <description>Use pure functions where possible - functions should have clear inputs and outputs without side effects</description>
        </subrule>
        <subrule id="12.2">
            <description>Keep functions small and focused on a single responsibility (max 20-30 lines per function)</description>
        </subrule>
        <subrule id="12.3">
            <description>Use descriptive function names that clearly indicate their purpose (verb-noun format)</description>
        </subrule>
        <subrule id="12.4">
            <description>Include docstrings for all functions explaining purpose, parameters, return values, and any side effects</description>
        </subrule>
        <subrule id="12.5">
            <description>Avoid deep nesting - use early returns and guard clauses to flatten code structure</description>
        </subrule>
        <subrule id="12.6">
            <description>Use meaningful variable names that describe their purpose, avoiding single-letter names except for simple iterators</description>
        </subrule>
        <subrule id="12.7">
            <description>Follow PEP 8 style guidelines for consistent formatting and naming conventions</description>
        </subrule>
        <subrule id="12.8">
            <description>Use type hints for function parameters and return values to improve readability</description>
        </subrule>
        <subrule id="12.9">
            <description>Structure code with clear separation of concerns - database logic, business logic, and presentation logic should be separated</description>
        </subrule>
        <subrule id="12.10">
            <description>Avoid global variables - use function parameters and return values to pass data between functions</description>
        </subrule>
    </rule>
</rules>